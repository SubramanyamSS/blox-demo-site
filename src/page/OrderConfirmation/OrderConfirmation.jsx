import React, { useState } from 'react'
import {
    ConfigConsumer
} from '../../container'
import { getCookie } from '../../common'

import { RenderMailBox,RenderOrderItems } from './renderProps'

import { TitleEl, CartItemsWrapper } from './styled'

let html_string = '<!DOCTYPE html><html><!DOCTYPE html><html> <head> <title>TATA VUEMAIL</title> </head> <body> <div class="row"> <div class="column"> <p style="text-align: left;">Hello {user_id},<p> </div> <div class="column"> <p style="text-align: left;">Based on your recent activity, we thought you might be interested in these products</p> </div> <div class="column" style="margin-top: 3rem;text-align: center;"> <h3>Browsing based recommendation</h3> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=1&mad_uuid={mad_uuid}&user_id={user_id}&image_no=0&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=1&mad_uuid={mad_uuid}&user_id={user_id}&image_no=0&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=1&mad_uuid={mad_uuid}&user_id={user_id}&image_no=1&width=200&height=300&ts={ts}&template={template_name}" <img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=1&mad_uuid={mad_uuid}&user_id={user_id}&image_no=1&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=1&mad_uuid={mad_uuid}&user_id={user_id}&image_no=2&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=1&mad_uuid={mad_uuid}&user_id={user_id}&image_no=2&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=1&mad_uuid={mad_uuid}&user_id={user_id}&image_no=3&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=1&mad_uuid={mad_uuid}&user_id={user_id}&image_no=3&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=1&mad_uuid={mad_uuid}&user_id={user_id}&image_no=4&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=1&mad_uuid={mad_uuid}&user_id={user_id}&image_no=4&width=200&height=300&ts={ts}&template={template_name}"></a> </div> <!-- <div class="column" style="margin-top: 1rem;text-align: center;"> <h4>Trending</h4> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=3&mad_uuid={mad_uuid}&user_id={user_id}&image_no=0&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=3&mad_uuid={mad_uuid}&user_id={user_id}&image_no=0&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=3&mad_uuid={mad_uuid}&user_id={user_id}&image_no=1&width=200&height=300&ts={ts}&template={template_name}" <img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=3&mad_uuid={mad_uuid}&user_id={user_id}&image_no=1&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=3&mad_uuid={mad_uuid}&user_id={user_id}&image_no=2&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=3&mad_uuid={mad_uuid}&user_id={user_id}&image_no=2&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=3&mad_uuid={mad_uuid}&user_id={user_id}&image_no=3&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=3&mad_uuid={mad_uuid}&user_id={user_id}&image_no=3&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=3&mad_uuid={mad_uuid}&user_id={user_id}&image_no=4&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=3&mad_uuid={mad_uuid}&user_id={user_id}&image_no=4&width=200&height=300&ts={ts}&template={template_name}"></a> </div> --> <div class="column" style="margin-top: 1rem;text-align: center;"> <h3>Recently Viewed Products </h3> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=7&mad_uuid={mad_uuid}&user_id={user_id}&image_no=0&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=7&mad_uuid={mad_uuid}&user_id={user_id}&image_no=0&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=7&mad_uuid={mad_uuid}&user_id={user_id}&image_no=1&width=200&height=300&ts={ts}&template={template_name}" <img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=7&mad_uuid={mad_uuid}&user_id={user_id}&image_no=1&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=7&mad_uuid={mad_uuid}&user_id={user_id}&image_no=2&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=7&mad_uuid={mad_uuid}&user_id={user_id}&image_no=2&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=7&mad_uuid={mad_uuid}&user_id={user_id}&image_no=3&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=7&mad_uuid={mad_uuid}&user_id={user_id}&image_no=3&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=7&mad_uuid={mad_uuid}&user_id={user_id}&image_no=4&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=7&mad_uuid={mad_uuid}&user_id={user_id}&image_no=4&width=200&height=300&ts={ts}&template={template_name}"></a> </div> <div class="column" style="margin-top: 1rem;text-align: center;"> <h3>Recommended for you</h3> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=11&mad_uuid={mad_uuid}&user_id={user_id}&image_no=0&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=11&mad_uuid={mad_uuid}&user_id={user_id}&image_no=0&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=11&mad_uuid={mad_uuid}&user_id={user_id}&image_no=1&width=200&height=300&ts={ts}&template={template_name}" <img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=11&mad_uuid={mad_uuid}&user_id={user_id}&image_no=1&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=11&mad_uuid={mad_uuid}&user_id={user_id}&image_no=2&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=11&mad_uuid={mad_uuid}&user_id={user_id}&image_no=2&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=11&mad_uuid={mad_uuid}&user_id={user_id}&image_no=3&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=11&mad_uuid={mad_uuid}&user_id={user_id}&image_no=3&width=200&height=300&ts={ts}&template={template_name}"></a> <a href = "{vuemail_endpoint}/link/?num_results={num_results}&api_key={api_key}&widget_id=11&mad_uuid={mad_uuid}&user_id={user_id}&image_no=4&width=200&height=300&ts={ts}&template={template_name}"><img src="{vuemail_endpoint}/image/?num_results={num_results}&api_key={api_key}&widget_id=11&mad_uuid={mad_uuid}&user_id={user_id}&image_no=4&width=200&height=300&ts={ts}&template={template_name}"></a> </div> </body></html> </body></html>'

const OrderConfirmation = props => {
    const [email_preview, update_email_preview] = useState(false);
    return <>
        <CartItemsWrapper>
            <ConfigConsumer>
                {context => {
                    const {
                        vue_mail
                    } = context
                    let API_KEY = context.API_KEY
                    let mad_UUID = getCookie('mad_UUID')
                    let user_id = localStorage.getItem('userId')
                    if (!user_id) {
                        user_id = context.user_id
                    }
                    let {
                        endPoint,
                        num_results,
                        template_name,
                        active
                    } = vue_mail
                    let api_key = API_KEY
                    let widget_id = '1'                    
                    let d = new Date();
                    let ts = d.getTime();
                    html_string = html_string.replace(/{vuemail_endpoint}/g, endPoint).replace(/{num_results}/g, num_results).replace(/{api_key}/g, api_key).replace(/{widget_id}/g, widget_id)
                    .replace(/{mad_uuid}/g, mad_UUID).replace(/{user_id}/g, user_id).replace(/{template_name}/g, template_name).replace(/{ts}/g, ts)
                    

                    return <>
                    <RenderOrderItems html_string={html_string} email_preview={email_preview} update_email_preview={update_email_preview} active={active}></RenderOrderItems>

                    <RenderMailBox html_string={html_string} email_preview={email_preview}></RenderMailBox>
                    </>
                }}
            </ConfigConsumer>
        </CartItemsWrapper>
    </>
}

export { OrderConfirmation }
